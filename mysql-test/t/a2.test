--source include/have_innodb.inc

--let $number_of_steps=17

CREATE COMPRESSION_DICTIONARY greek ('alphabetagammadeltaepsilonzetaetathetaiotakappalambdamunuxiomicronpirhosigmatauupsilonphichipsiomega');

CREATE TABLE t1(
  id INT,
  a BLOB
) ENGINE=InnoDB;

CREATE TABLE t2(
  id INT,
  a BLOB COLUMN_FORMAT COMPRESSED
) ENGINE=InnoDB;

CREATE TABLE t3(
  id INT,
  a BLOB COLUMN_FORMAT COMPRESSED WITH COMPRESSION_DICTIONARY greek
) ENGINE=InnoDB;

SELECT * FROM information_schema.xtradb_zip_dict;
SELECT * FROM information_schema.xtradb_zip_dict_cols;

SET @json_value =
  '{\n'
  '  "alpha"   = 1,\n'
  '  "beta"    = 2,\n'
  '  "gamma"   = 3,\n'
  '  "delta"   = 4,\n'
  '  "epsilon" = 5,\n'
  '  "zeta"    = 6,\n'
  '  "eta"     = 7,\n'
  '  "theta"   = 8,\n'
  '  "iota"    = 9,\n'
  '  "kappa"   = 10,\n'
  '  "lambda"  = 11,\n'
  '  "mu"      = 12,\n'
  '  "nu"      = 13,\n'
  '  "xi"      = 14,\n'
  '  "omicron" = 15,\n'
  '  "pi"      = 16,\n'
  '  "rho"     = 17,\n'
  '  "sigma"   = 18,\n'
  '  "tau"     = 19,\n'
  '  "upsilon" = 20,\n'
  '  "phi"     = 21,\n'
  '  "chi"     = 22,\n'
  '  "psi"     = 23,\n'
  '  "omega"   = 24\n'
  '}\n'
;

INSERT INTO t1 VALUES(0, @json_value);
SELECT * FROM t1;

INSERT INTO t2 VALUES(0, @json_value);
SELECT * FROM t2;

INSERT INTO t3 VALUES(0, @json_value);
SELECT * FROM t3;

--let $i=$number_of_steps
while($i)
{
  INSERT INTO t1 SELECT * FROM t1;
  --dec $i
}

--let $i=$number_of_steps
while($i)
{
  INSERT INTO t2 SELECT * FROM t2;
  --dec $i
}

--let $i=$number_of_steps
while($i)
{
  INSERT INTO t3 SELECT * FROM t3;
  --dec $i
}

#DROP TABLE t1, t2, t3;
